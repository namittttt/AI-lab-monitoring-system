(self.modernJsonp=self.modernJsonp||[]).push([["55759"],{130442:function(e,t,n){n.r(t),n.d(t,{default:()=>O});var i=n(686659),o=n(667294),a=n(312048),r=n(20256),l=n(943564),s=n(724985),d=n(290852),c=n(689157),u=n(752031),p=n(746868),m=n(470205),h=n(935059),y=n(765603),g=n(774838),x=n(575820),v=n(200619),C=n(601871),P=n(15392),f=n(113759),w=n(632492),j=n(510755),b=n(328299),T=n(9065),S=n(785893);let _=(0,T.Z)(()=>Promise.all([n.e("25418"),n.e("38782"),n.e("78159"),n.e("18164"),n.e("48469"),n.e("85736"),n.e("64701")]).then(n.bind(n,785177)),void 0,e=>785177,"SaveAffordance",e=>["25418","38782","78159","18164","48469","85736","64701"]),I=(0,T.Z)(()=>n.e("73301").then(n.bind(n,225406)),void 0,e=>225406,"PostDownloadUpsellPopover",e=>["73301"]),k=(0,T.Z)(()=>Promise.resolve().then(n.bind(n,64897)),void 0,e=>64897,"SecondarySendButtonCommon",e=>[]),D=(0,T.Z)(()=>Promise.all([n.e("25418"),n.e("96415")]).then(n.bind(n,872901)),void 0,e=>872901,"ReactionPickerContainer",e=>["25418","96415"]),R=(0,T.Z)(()=>n.e("8419").then(n.bind(n,78316)),void 0,e=>78316,"CloseupCommentButton",e=>["8419"]),E=(0,o.memo)(function({goBack:e,gridDescription:t,isDeletedStoryPin:n,inCommentsImprovedDropdownExp:i,inCommentsPopoverExp:T,isEligibleForAggregatedComments:E,isEligibleForPinReactions:O,isOnSecretBoard:Z,onEditSubmit:A,pin:B,viewParameter:N,viewType:M,onSaveButtonClick:L,showRepinOnInitialRender:W,isStoryPin:z,actionBarContainerRef:H,outerPaddingSize:U=P.g9,maxWidth:F,showLeadPin:G,scrollContainerRef:Y}){let K=(0,a.TH)(),J=(0,v.Z)(),{showEnabledSaveBehavior:X}=(0,b.Yh)(!0),{imgSrc:$}=(0,u.G)(),{clientTrackingParams:q,showCloseupContentRight:Q,closeupWithinMasonryEnabled:V,peekCloseupEnabled:ee}=(0,f.x4)(),{viewType:et,viewParameter:en}=(0,p.SU)(),ei=(0,h.Z)(),eo=(0,C.q6)(ei,B?.pinner?.id,J),ea=(0,c.Z)({showProductDetailPage:!!B.is_eligible_for_pdp}),[er,el]=(0,o.useState)(!!(0,x.mB)(K.search).share),[es,ed]=(0,o.useState)(!1),{shareFromPostDownloadUpsell:ec,setShareFromPostDownloadUpsell:eu,saveToBoardFromPostDownloadUpsell:ep,setSaveToBoardFromPostDownloadUpsell:em}=(0,l.tS)();(0,o.useEffect)(()=>{ec&&(el(!0),eu(!1))},[ec,eu]);let eh=(0,o.useCallback)(e=>ed(e),[]),ey=(0,o.useCallback)(()=>el(!1),[]),eg=(0,o.useCallback)(()=>el(e=>!e),[]),ex=B.board?.owner?.id||B.pinner?.id,{aggregated_pin_data:ev,comments_disabled:eC,reaction_counts:eP}=B,{isRTL:ef}=(0,g.B)(),ew=V?F:F||P.Gg,ej=(0,d.Z)({pinKey:{type:"Legacy",data:B},orbacActingAs:J,viewer:ei}),eb=!!Object.keys(eP||{}).length,eT=ev?.did_it_data?.images_count??0,eS=(ev?.comment_count??0)+eT,e_=Z||n?null:(0,S.jsx)(m.Z,{name:"CloseupActionBar_SecondarySendButton",children:(0,S.jsx)(k,{closeupWithinMasonryEnabled:V,controllerOptions:{flyoutDisplayOptions:V?{shownWithinProfileHeader:!0,idealDirection:"down",forceDirection:!0}:{wrapperPosition:"fixed"},isFlyoutOpen:er,loggingOptions:{component:194,element:72,viewParameter:N||en,viewType:M||et},onFlyoutDismiss:ey,onToggleFlyout:eg,sendObject:{type:"pin",description:t,id:B.id,imageUrl:$,ownerId:ex,url:`/pin/${B.id}/`,clientTrackingParams:q}},showSendAnimation:!0})}),eI=(0,S.jsx)(r.xu,{alignItems:"center",color:V?"transparent":"default","data-test-id":"closeup-action-items",display:"flex",justifyContent:"between",maxWidth:ew,role:"list",rounding:2,children:(0,S.jsxs)(r.kC,{alignItems:"stretch",gap:2*!!V,justifyContent:"start",children:[!eo&&!!O&&(0,S.jsx)(m.Z,{name:"CloseupActionBar_ReactionPickerContainer",children:(0,S.jsxs)(r.xu,{alignItems:"center",display:"flex",marginEnd:2*!!eb,role:"listitem",children:[(0,S.jsx)(D,{clientTrackingParams:q,handleReactionTrayHover:eh,idealDirection:V?"down":void 0,pinId:B.id,reactionByMe:B.reaction_by_me,showTooltip:!0,viewParameter:N,viewType:M}),(0,S.jsx)(y.Z,{pinId:B.id,reactionCounts:eP,showPrettyNumber:!0})]})}),V&&!(i&&eC)&&(0,S.jsx)(R,{inCommentsImprovedDropdownExp:!!i,inCommentsPopoverExp:!!T,isEligibleForAggregatedComments:!!E,pinKey:{type:"Legacy",data:B},scrollContainerRef:Y,shouldShowCommentCount:!eC&&!!eS&&(!!T||!!i),totalCommentCount:eS,viewParameter:N,viewType:M}),(0,S.jsx)(r.xu,{role:"listitem",children:e_}),(0,S.jsx)(r.xu,{"data-test-id":"closeup-more-options",role:"listitem",children:(0,S.jsx)(s.Z,{carouselSlotCurrentIndex:B&&B.carousel_data&&B.carousel_data.index,clientTrackingParams:q,closeupWithinMasonryEnabled:V,goBack:e,isReactionTrayOpen:es,onEditSubmit:A,pinKey:{type:"Legacy",data:B},showEditPin:!n&&ej,viewParameter:N,viewType:M})})]})}),ek=V?void 0:U,eD=(0,S.jsxs)(r.xu,{ref:H,color:"default",dangerouslySetInlineStyle:{__style:{paddingTop:U/2,paddingRight:ef?void 0:ek,paddingLeft:ef?ek:void 0,paddingBottom:V?U/2:void 0,borderRadius:z?"0px 32px 32px 32px":Q?"0px 32px 32px 0":void 0}},"data-test-id":"closeup-body-sticky-content",marginTop:V?0:z?-5:0,width:V?"100%":void 0,children:[(0,S.jsx)(r.xu,{"data-test-id":"closeupActionBar",marginStart:ea?-3:void 0,children:(0,S.jsxs)(r.kC,{alignItems:"stretch",justifyContent:"between",children:[eI,(0,S.jsx)(r.kC,{alignItems:"center",gap:2,children:!n&&!eo&&(0,S.jsx)(r.xu,{marginStart:3*!V,children:(0,S.jsx)(_,{boardCount:ei.isAuth?ei.boardCount:0,clientTrackingParams:q,onClickCallback:L,pinKey:{type:"Legacy",data:B},saveToBoardFromPostDownloadUpsell:ep,setSaveToBoardFromPostDownloadUpsell:em,showEnabledSaveBehavior:X,showRepinOnInitialRender:W,variant:"closeup",viewParameter:N,viewType:M})})})]})}),(0,S.jsx)(I,{})]});if(G||V)return eD;let eR=z&&!ee?j.cI+4:j.hu;return ee&&(eR=0),(0,S.jsx)(r.Le,{top:eR,zIndex:w.mS,children:eD})});function O(e){return(0,o.useEffect)(()=>{(0,i.Z)("CloseupActionBar","/app/common/react/components/closeup/CloseupActionBar/CloseupActionBar.tsx")},[]),(0,S.jsx)(E,{...e})}},765603:function(e,t,n){n.d(t,{Z:()=>g});var i=n(667294),o=n(20256),a=n(361004),r=n(104999),l=n(24246),s=n(507006),d=n(729586),c=n(518596),u=n(825605),p=n(785893);function m(e,t,n){var i;return(t="symbol"==typeof(i=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?i:i+"")in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}let h=(0,i.lazy)(()=>n.e("25993").then(n.bind(n,581897)));class y extends i.PureComponent{constructor(...e){super(...e),m(this,"state",{displayAggregationModal:!1}),m(this,"showAggregationModal",()=>{let{disableModal:e,logContextEvent:t}=this.props;e||(this.setState({displayAggregationModal:!0}),t({event_type:101,view_type:3,view_parameter:139,component:13458,element:11435,aux_data:{objectId:this.props.pinId}}))}),m(this,"hideAggregationModal",()=>{this.setState({displayAggregationModal:!1})})}render(){let{displayAggregationModal:e}=this.state,{isBold:t,isStoryPin:n,paddingY:i,pinId:r,reactionCounts:l,showPrettyNumber:m,size:y}=this.props,g=l?(0,c.At)(l):null,x=l?(0,c.Ud)(l):0,v=!!g&&g.length>0&&g.filter(e=>!!d.GY[e]).map((e,t)=>{let n=e&&d.GY[e]?d.GY[e]:"",{label:i,gridAsset:a}=(0,d.fW)(n,this.props.i18n);return(0,p.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:{marginRight:2}},children:(0,p.jsx)(o.xu,{height:19,width:19,children:a&&(0,p.jsx)(o.Ee,{alt:i??"",fit:"cover",naturalHeight:1,naturalWidth:1,src:a})})},t)});return(0,p.jsxs)(o.xu,{children:[(0,p.jsx)(o.iP,{accessibilityLabel:`${x} reactions`,dataTestId:"reactions-count-button",onTap:this.showAggregationModal,children:!!v&&(0,p.jsx)(o.xu,{"data-test-id":"aggregated-reactions-container",display:"inlineBlock",children:m?(0,p.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:{cursor:"pointer"}},children:(0,p.jsx)(o.xv,{size:y??a.n,weight:"bold",children:(0,p.jsx)(s.Z,{shortform:!0,shortformMaximumFractionDigits:1,value:x})})}):(0,p.jsxs)(o.xu,{alignItems:"center",dangerouslySetInlineStyle:{__style:{cursor:"pointer"}},"data-test-id":"aggregated-reactions-container",direction:"row",display:"flex",height:n?"auto":19,paddingY:i??6*!n,children:[(0,p.jsx)(o.kC,{alignItems:"stretch",direction:"row",justifyContent:"start",children:v}),(0,p.jsx)(o.xu,{paddingX:1,children:(0,p.jsx)(o.xv,{color:t?"default":"subtle",size:y??a.n,weight:t?"bold":"normal",children:(0,p.jsx)(s.Z,{shortform:!0,shortformMaximumFractionDigits:1,value:x})})})]})})}),e&&x&&(0,p.jsx)(u.Z,{children:(0,p.jsx)(h,{aggregatedReactions:v,onDismiss:this.hideAggregationModal,pinId:r,totalReactionCount:x})})]})}}m(y,"defaultProps",{isBold:!0});let g=function(e){let t=(0,l.Z)(),n=(0,r.Z)();return(0,p.jsx)(y,{...e,i18n:t,logContextEvent:n})}},985543:function(e,t,n){n.d(t,{X:()=>c,Z:()=>d});var i=n(667294),o=n(213491),a=n(566431);function r(e=null,t){switch(t.type){case"REPORT_CONTENT_SHOW":return{id:t.payload.id,auxData:t.payload.auxData,isProduct:t.payload.isProduct,isPromoted:t.payload.isPromoted,parentId:t.payload.parentId,videoDuration:t.payload.videoDuration,viewParameter:t.payload.viewParameter,viewType:t.payload.viewType,type:t.payload.type,isThirdPartyAd:t.payload.isThirdPartyAd,nodeId:t.payload.nodeId};case"REPORT_CONTENT_DISMISS":return null;default:return e}}var l=n(785893);let{Provider:s,get:d}=(0,o.Z)("ReportData");function c({children:e}){let[t,n]=(0,i.useReducer)(r,null),o=(0,i.useCallback)(()=>n({type:"REPORT_CONTENT_DISMISS"}),[]),d=(0,i.useCallback)((e,t,i)=>n({type:"REPORT_CONTENT_SHOW",payload:{id:e,isProduct:!1,isPromoted:!1,parentId:t,videoDuration:null,viewParameter:null,viewType:null,type:i,nodeId:null}}),[]),c=(0,i.useCallback)((e,t,i)=>n({type:"REPORT_CONTENT_SHOW",payload:{id:e,isProduct:!1,isPromoted:!1,videoDuration:null,viewParameter:t,viewType:i,type:"conversation",nodeId:null}}),[]),u=(0,i.useCallback)(({id:e,viewParameter:t,viewType:i,nodeId:o})=>n({type:"REPORT_CONTENT_SHOW",payload:{id:e,isProduct:!1,isPromoted:!1,videoDuration:null,viewParameter:t,viewType:i,type:"pin",nodeId:o}}),[]),p=(0,i.useCallback)(({pinId:e,isDownstreamPromotion:t,hasPromoter:i,firstVideoDuration:o,isProduct:r,viewParameter:l,viewType:s,isThirdPartyAd:d,nodeId:c,auxData:u})=>{n({type:"REPORT_CONTENT_SHOW",payload:{id:e,auxData:u,isProduct:r,isPromoted:(0,a.jL)(t,i),videoDuration:o,viewParameter:l,viewType:s,type:"pin",isThirdPartyAd:d,nodeId:c}})},[]),m=(0,i.useMemo)(()=>({reportData:t,dismiss:o,reportComment:d,reportConversation:c,reportImage:u,reportPin:p}),[t,o,d,c,u,p]);return(0,l.jsx)(s,{value:m,children:e})}}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/CloseupActionBarCommon-6c6dde2d8dfcfba2.mjs.map